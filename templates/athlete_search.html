{% extends "base.html" %}

{% block title %}Athletes - Search & Leaderboards{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="https://static.protridata.com/css/athlete_search.css">
{% endblock %}

{% block content %}
<div class="athlete-page">
    <section class="athlete-hero">
        <div class="hero-copy">
            <h1>Athlete Database</h1>
            <p class="hero-lede">
                Search for an athlete and view their results from every World Triathlon race held.
            </p>
            <div class="hero-stats">
                <div class="stat-pill">
                    <span class="stat-label">Athletes tracked</span>
                    <span class="stat-value">{{ total_athletes }}</span>
                </div>
                <div class="stat-pill">
                    <span class="stat-label">Countries represented</span>
                    <span class="stat-value">{{ total_countries }}</span>
                </div>
            </div>
        </div>

        <div class="search-card">
            <div class="search-card-header">
                <p class="search-label">Search athletes</p>
                <h3>Find an athlete</h3>
            </div>
            <div class="search-container">
                <div class="search-input-wrapper">
                    <input 
                        type="text" 
                        id="athleteSearch" 
                        class="search-input" 
                        placeholder="Search for an athlete..."
                        autocomplete="off"
                    >
                    <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                </div>
                
                <div id="searchResults" class="search-results" style="display: none;">
                    <!-- Results populated by JS -->
                </div>
            </div>
        </div>
    </section>

    <section class="comparison-callout">
        <div class="comparison-callout-card">
            <div class="comparison-callout-copy">
                <p class="comparison-eyebrow">Head-to-head</p>
                <h2 class="comparison-title">Compare two athletes across their careers</h2>
                <p class="comparison-text">
                    Pick any two athletes to line up ratings, head-to-head results, and performance trends over time.
                </p>
            </div>
            <a href="/compare" class="comparison-link">Open comparison</a>
        </div>
    </section>

    <section class="leaderboards-section">
        <h2 class="section-title">All-Time Leaderboards</h2>
        <div class="leaderboard-grid">
            <article class="leaderboard-card">
                <div class="leaderboard-card-header">
                    <div>
                        <p class="leaderboard-eyebrow">Women</p>
                    </div>
                    <a href="/leaderboard" class="leaderboard-link">See All</a>
                </div>
                <div class="podium-steps">
                    {% for athlete in female_podium %}
                    <a href="/athlete/{{ athlete.athlete_id }}" class="podium-step position-{{ loop.index }}">
                        <div class="podium-avatar-wrap">
                            <img src="{{ 'https://static.protridata.com/athlete_imgs/64/' ~ athlete.athlete_id ~ '.webp' if athlete.profile_img_exists else 'https://static.protridata.com/imgs/default_user.jpg' }}"
                                 alt="{{ athlete.name }}"
                                 loading="lazy"
                                 class="podium-avatar">
                        </div>
                        <div class="podium-rating">{{ athlete.overall_rating }}</div>
                        <div class="podium-name">{{ athlete.name }}</div>
                        <div class="podium-meta">{{ athlete.country_full }}</div>
                    </a>
                    {% endfor %}
                </div>
            </article>

            <article class="leaderboard-card">
                <div class="leaderboard-card-header">
                    <div>
                        <p class="leaderboard-eyebrow">Men</p>
                    </div>
                    <a href="/leaderboard?gender=male" class="leaderboard-link">See All</a>
                </div>
                <div class="podium-steps">
                    {% for athlete in male_podium %}
                    <a href="/athlete/{{ athlete.athlete_id }}" class="podium-step position-{{ loop.index }}">
                        <div class="podium-avatar-wrap">
                            <img src="{{ 'https://static.protridata.com/athlete_imgs/64/' ~ athlete.athlete_id ~ '.webp' if athlete.profile_img_exists|default(false) else 'https://static.protridata.com/imgs/default_user.jpg' }}"
                                 alt="{{ athlete.name }}"
                                 loading="lazy"
                                 class="podium-avatar">
                        </div>
                        <div class="podium-rating">{{ athlete.overall_rating }}</div>
                        <div class="podium-name">{{ athlete.name }}</div>
                        <div class="podium-meta">{{ athlete.country_full }}</div>
                    </a>
                    {% endfor %}
                </div>
            </article>
        </div>
    </section>
</div>
{% endblock %}

{% block extra_js %}
<script src="https://static.protridata.com/js/utils.js"></script>
<script src="https://static.protridata.com/js/athlete_search.js"></script>
{% endblock %}
